!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs"),require("rxjs/operators"),require("rxjs/index"),require("@angular/core"),require("@angular/common"),require("@angular/common/http")):"function"==typeof define&&define.amd?define("facephi-selphid",["exports","rxjs","rxjs/operators","rxjs/index","@angular/core","@angular/common","@angular/common/http"],e):e(t["facephi-selphid"]={},t.rxjs,t.rxjs.operators,t.rxjs.index,t.ng.core,t.ng.common,t.ng.common.http)}(this,function(t,n,e,r,i,o,a){"use strict";var s=(u.poll=function(t,e,i,n){void 0===n&&(n=0);var o=r.timer(n,t).subscribe(function(){e()&&(o.unsubscribe(),i())})},u);function u(){}var p=(Object.defineProperty(c.prototype,"fPhiSelphIdNamespace",{get:function(){return window.FPhi&&window.FPhi.SelphID?window.FPhi.SelphID:undefined},set:function(t){window.FPhi&&(window.FPhi.SelphID=t)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"fPhiWidgetScriptPath",{get:function(){return this._assetsBasePath+"/FPhi.Widget.wasm.js"},enumerable:!0,configurable:!0}),c.prototype.loadControl=function(t){var e=this;this._assetsBasePath=t;var i=this._renderer.createElement("script");return this._renderer.setAttribute(i,"src",this.fPhiWidgetScriptPath),this._renderer.setAttribute(i,"type","text/javascript"),this._renderer.appendChild(this.document.body,i),new n.Observable(function(t){s.poll(5,function(){return null!==e.fPhiSelphIdNamespace&&e.fPhiSelphIdNamespace!==undefined&&null!==e.fPhiSelphIdNamespace.Widget&&e.fPhiSelphIdNamespace.Widget!==undefined},function(){return t.next(e)})})},c.prototype.removeControl=function(){return this._assetsBasePath&&(delete this._fPhiWidget,delete this._fPhiWidgetConfiguration,delete this.fPhiSelphIdNamespace,this._fPhiWidget=undefined,this._fPhiWidgetConfiguration=undefined,this.fPhiSelphIdNamespace=undefined,this.document.querySelectorAll('script[src*="'+this._assetsBasePath+'"]').forEach(function(t){t.parentNode.removeChild(t)}),this.document.querySelectorAll("style#FPhi_Widget_style").forEach(function(t){t.parentNode.removeChild(t)})),this},c.prototype.createUserControl=function(t){return this._fPhiWidgetConfiguration=t,this._fPhiWidget=new this.fPhiSelphIdNamespace.Widget(t.getNativeConfiguration()),null!==this._fPhiWidgetConfiguration.debugMode&&this._fPhiWidgetConfiguration.debugMode!==undefined&&(this._fPhiWidget.debug=this._fPhiWidgetConfiguration.debugMode),this},c.prototype.startUserControl=function(){return this._fPhiWidget&&this._fPhiWidget.Start(),this},c.prototype.stopUserControl=function(){return this._fPhiWidget&&this._fPhiWidget.Stop(),this},c.prototype.isWidgetLicensed=function(){return this.http.get(c.licenseCheckUrl,{observe:"response"}).pipe(e.map(function(t){return 403!==t.status}))},c.licenseCheckUrl="https://ecertic.idcapture.es/auth",c.decorators=[{type:i.Injectable,args:[{providedIn:"root"}]}],c.ctorParameters=function(){return[{type:undefined,decorators:[{type:i.Inject,args:[o.DOCUMENT]}]},{type:i.RendererFactory2},{type:a.HttpClient}]},c.ngInjectableDef=i.defineInjectable({factory:function(){return new c(i.inject(o.DOCUMENT),i.inject(i.RendererFactory2),i.inject(a.HttpClient))},token:c,providedIn:"root"}),c);function c(t,e,i){this.document=t,this.rendererFactory=e,this.http=i,this._renderer=this.rendererFactory.createRenderer(null,null)}var d=(h.prototype.getNativeConfiguration=function(){var t=new window.FPhi.SelphID.ConfigurationManager;return this.setNativeConfiguration(this.widgetContainer,t.setContainer,t),this.setNativeConfiguration(this.language,t.setLanguage,t),this.setNativeConfiguration(this.dpiList,t.setDpiList,t),this.setNativeConfiguration(this.captureMode,t.setMode,t),this.setNativeConfiguration(this.previewCapture,t.setPreview,t),this.setNativeConfiguration(this.documentDimensions,t.setDocumentDimensions,t),this.setNativeConfiguration(this.qualityThreshold,t.setQualityThreshold,t),this.setNativeConfiguration(this.cropFactor,t.setCropFactor,t),this.setNativeConfiguration(this.forceLandscape,t.setForceLandscape,t),this.setNativeConfiguration(this.canvasHD,t.setCanvasHD,t),this.setNativeConfiguration(this.initialTip,t.setInitialTip,t),this.setNativeConfiguration(this.cameraWidth,t.setCameraWidth,t),this.setNativeConfiguration(this.cameraHeight,t.setCameraHeight,t),this.setNativeConfiguration(this.cameraId,t.setCameraId,t),this.setNativeConfiguration(this.captureTimeout,t.setCaptureTimeout,t),this.setNativeConfiguration(this.captureRetries,t.setCaptureRetries,t),this.setNativeConfiguration(this.captureSensibility,t.setCaptureSensibility,t),this.setNativeConfiguration(this.imageFormat,t.setImageFormat,t),this.setNativeConfiguration(this.imageQuality,t.setImageQuality,t),this.setNativeConfiguration(this.onModuleLoaded,t.setOnModuleLoaded,t),this.setNativeConfiguration(this.onExtractionFinished,t.setOnExtractionFinish,t),this.setNativeConfiguration(this.onUserCancelled,t.setOnUserCancel,t),this.setNativeConfiguration(this.onExceptionCaptured,t.setOnExceptionCaptured,t),this.setNativeConfiguration(this.onExtractionTimeout,t.setOnExtractionTimeout,t),this.setNativeConfiguration(this.onTrackStatus,t.setOnTrackStatus,t),t},h.prototype.setNativeConfiguration=function(t,e,i){void 0===i&&(i=null),null!==t&&t!==undefined&&(i?e.bind(i):e)(t)},h);function h(){this.debugMode=!1}function g(){}var f=(Object.defineProperty(l.prototype,"cssClass",{get:function(){return this._cssClass},set:function(t){t&&(this._cssClass+=" "+t)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"widgetWidth",{get:function(){return this.componentWidth?"string"==typeof this.componentWidth&&this.componentWidth.endsWith("%")?this.componentWidth:parseFloat(this.componentWidth)+"px":"100%"},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"widgetHeight",{get:function(){return this.componentHeight?"string"==typeof this.componentWidth&&this.componentHeight.endsWith("%")?this.componentHeight:parseFloat(this.componentHeight)+"px":"100%"},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"language",{get:function(){return this._widgetConfiguration.language},set:function(t){this._widgetConfiguration.language=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"dpiList",{get:function(){return this._widgetConfiguration.dpiList},set:function(t){this._widgetConfiguration.dpiList=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"captureMode",{get:function(){return this._widgetConfiguration.captureMode},set:function(t){this._widgetConfiguration.captureMode=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"previewCapture",{get:function(){return this._widgetConfiguration.previewCapture},set:function(t){this._widgetConfiguration.previewCapture=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"documentDimensions",{get:function(){return this._widgetConfiguration.documentDimensions},set:function(t){this._widgetConfiguration.documentDimensions=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"qualityThreshold",{get:function(){return this._widgetConfiguration.qualityThreshold},set:function(t){this._widgetConfiguration.qualityThreshold=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"cropFactor",{get:function(){return this._widgetConfiguration.cropFactor},set:function(t){this._widgetConfiguration.cropFactor=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"forceLandscape",{get:function(){return this._widgetConfiguration.forceLandscape},set:function(t){this._widgetConfiguration.forceLandscape=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"canvasHD",{get:function(){return this._widgetConfiguration.canvasHD},set:function(t){this._widgetConfiguration.canvasHD=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"initialTip",{get:function(){return this._widgetConfiguration.initialTip},set:function(t){this._widgetConfiguration.initialTip=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"cameraWidth",{get:function(){return this._widgetConfiguration.cameraWidth},set:function(t){this._widgetConfiguration.cameraWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"cameraHeight",{get:function(){return this._widgetConfiguration.cameraHeight},set:function(t){this._widgetConfiguration.cameraHeight=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"cameraId",{get:function(){return this._widgetConfiguration.cameraId},set:function(t){this._widgetConfiguration.cameraId=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"captureTimeout",{get:function(){return this._widgetConfiguration.captureTimeout},set:function(t){this._widgetConfiguration.captureTimeout=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"captureRetries",{get:function(){return this._widgetConfiguration.captureRetries},set:function(t){this._widgetConfiguration.captureRetries=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"captureSensibility",{get:function(){return this._widgetConfiguration.captureSensibility},set:function(t){this._widgetConfiguration.captureSensibility=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"imageFormat",{get:function(){return this._widgetConfiguration.imageFormat},set:function(t){this._widgetConfiguration.imageFormat=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"imageQuality",{get:function(){return this._widgetConfiguration.imageQuality},set:function(t){this._widgetConfiguration.imageQuality=t},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"debugMode",{get:function(){return this._widgetConfiguration.debugMode},set:function(t){this._widgetConfiguration.debugMode=t},enumerable:!0,configurable:!0}),l.prototype.ngOnInit=function(){var t=this;function e(){t.onComponentLoaded.emit(),t.widgetService.createUserControl(t._widgetConfiguration).startUserControl()}this._widgetConfiguration.widgetContainer=this.widgetContainer.nativeElement,this.setupEvents(),this.autoLoadLibResources?this.widgetService.loadControl(this.widgetLibPath).subscribe(e):e()},l.prototype.ngOnDestroy=function(){this.autoLoadLibResources&&this.widgetService.stopUserControl().removeControl()},l.prototype.setupEvents=function(){var e=this;return this._widgetConfiguration.onModuleLoaded=function(t){e.onModuleLoaded.emit(t)},this._widgetConfiguration.onExtractionFinished=function(t){e.onExtractionFinished.emit(t)},this._widgetConfiguration.onUserCancelled=function(){e.onUserCancelled.emit()},this._widgetConfiguration.onExceptionCaptured=function(t){e.onExceptionCaptured.emit(t)},this._widgetConfiguration.onExtractionTimeout=function(){e.onExtractionTimeout.emit()},this._widgetConfiguration.onTrackStatus=function(t){e.onTrackStatus.emit(t)},this},l.decorators=[{type:i.Component,args:[{selector:"facephi-selphid",template:'<div #widgetContainer\n     [style.width]="widgetWidth"\n     [style.height]="widgetHeight"\n     [ngClass]="containerCssClass">\n</div>\n',styles:[""]}]}],l.ctorParameters=function(){return[{type:p}]},l.propDecorators={cssClass:[{type:i.Input,args:["class"]},{type:i.HostBinding,args:["class"]}],componentWidth:[{type:i.Input,args:["width"]}],componentHeight:[{type:i.Input,args:["height"]}],widgetContainer:[{type:i.ViewChild,args:["widgetContainer"]}],containerCssClass:[{type:i.Input}],widgetLibPath:[{type:i.Input}],autoLoadLibResources:[{type:i.Input}],language:[{type:i.Input}],dpiList:[{type:i.Input}],captureMode:[{type:i.Input}],previewCapture:[{type:i.Input}],documentDimensions:[{type:i.Input}],qualityThreshold:[{type:i.Input}],cropFactor:[{type:i.Input}],forceLandscape:[{type:i.Input}],canvasHD:[{type:i.Input}],initialTip:[{type:i.Input}],cameraWidth:[{type:i.Input}],cameraHeight:[{type:i.Input}],cameraId:[{type:i.Input}],captureTimeout:[{type:i.Input}],captureRetries:[{type:i.Input}],captureSensibility:[{type:i.Input}],imageFormat:[{type:i.Input}],imageQuality:[{type:i.Input}],debugMode:[{type:i.Input}],onComponentLoaded:[{type:i.Output}],onModuleLoaded:[{type:i.Output}],onExtractionFinished:[{type:i.Output}],onUserCancelled:[{type:i.Output}],onExceptionCaptured:[{type:i.Output}],onExtractionTimeout:[{type:i.Output}],onTrackStatus:[{type:i.Output}]},l);function l(t){this.widgetService=t,this._cssClass="",this._widgetConfiguration=new d,this.widgetLibPath="assets/lib/facephi/selphid",this.autoLoadLibResources=!0,this.onComponentLoaded=new i.EventEmitter,this.onModuleLoaded=new i.EventEmitter,this.onExtractionFinished=new i.EventEmitter,this.onUserCancelled=new i.EventEmitter,this.onExceptionCaptured=new i.EventEmitter,this.onExtractionTimeout=new i.EventEmitter,this.onTrackStatus=new i.EventEmitter}var m=(C.CaptureMode={Front:0,Back:1,Full:2},C.ExceptionType={CameraError:0,ExtractorError:1,ControlNotInitializedError:2,ImageCropResizeError:3,UnexpectedCaptureError:4},C.CaptureSensibility={Low:0,Normal:1,High:2,Auto:3},C.TrackStatus={ChangeState:0,Tap:1},C);function C(){}var y=(b.decorators=[{type:i.NgModule,args:[{declarations:[f],imports:[o.CommonModule,a.HttpClientModule],exports:[f]}]}],b);function b(){}t.FacePhiSelphIdComponent=f,t.FPhiSelphIdConfiguration=d,t.FPhiSelphIdDocumentDimensions=g,t.FPhiSelphIdConstants=m,t.FPhiSelphIdWidgetService=p,t.FacePhiSelphIdModule=y,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=facephi-selphid.umd.min.js.map