!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs"),require("rxjs/index"),require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define("facephi-selphi",["exports","rxjs","rxjs/index","@angular/core","@angular/common"],e):e(t["facephi-selphi"]={},t.rxjs,t.rxjs.index,t.ng.core,t.ng.common)}(this,function(t,n,r,e,i){"use strict";var o=(a.prototype.getNativeConfiguration=function(){var t=new window.FPhi.Selphi.ConfigurationManager;return this.setNativeConfiguration(this.widgetContainer,t.setContainer,t),this.setNativeConfiguration(this.resourcesPath,t.setResourcesPath,t),this.setNativeConfiguration(this.graphPath,t.setGraphPath,t),this.setNativeConfiguration(this.language,t.setLanguage,t),this.setNativeConfiguration(this.dpiList,t.setDpiList,t),this.setNativeConfiguration(this.tryParseInt(this.cameraWidth),t.setCameraWidth,t),this.setNativeConfiguration(this.tryParseInt(this.cameraHeight),t.setCameraHeight,t),this.setNativeConfiguration(this.tryParseInt(this.cameraRotation),t.setCameraRotation,t),this.setNativeConfiguration(this.tryParseInt(this.cameraType),t.setCameraType,t),this.setNativeConfiguration(this.tutorial,t.setTutorial,t),this.setNativeConfiguration(this.tryParseInt(this.extractionMode),t.setMode,t),this.setNativeConfiguration(this.tryParseInt(this.livenessMode),t.setLivenessMode,t),this.setNativeConfiguration(this.tryParseInt(this.livenessPrecision),t.setLivenessPrecision,t),this.setNativeConfiguration(this.tryParseInt(this.livenessMoveInitialError),t.setLivenessMoveInitialError,t),this.setNativeConfiguration(this.tryParseFloat(this.livenessMoveInfoTime),t.setLivenessMoveInfoTime,t),this.setNativeConfiguration(this.interactible,t.setInteractible,t),this.setNativeConfiguration(this.tryParseFloat(this.registerTime),t.setRegisterTime,t),this.setNativeConfiguration(this.tryParseFloat(this.authenticateTime),t.setAuthenticateTime,t),this.setNativeConfiguration(this.imageFormat,t.setImageFormat,t),this.setNativeConfiguration(this.tryParseFloat(this.imageQuality),t.setImageQuality,t),this.setNativeConfiguration(this.logImages,t.setLogImages,t),this.setNativeConfiguration(this.tryParseFloat(this.cropFactor),t.setCropFactor,t),this.setNativeConfiguration(this.cropImage,t.setCropImage,t),this.setNativeConfiguration(this.tryParseInt(this.templateFormat),t.setTemplateFormat,t),this.setNativeConfiguration(this.stabilizationStage,t.setStabilizationStage,t),this.setNativeConfiguration(this.videoRecord,t.setVideoRecord,t),this.setNativeConfiguration(this.tryParseInt(this.videoRecordRate),t.setVideoRecordRate,t),this.setNativeConfiguration(this.tryParseFloat(this.videoRecordScale),t.setVideoRecordScale,t),this.setNativeConfiguration(this.tryParseInt(this.videoRecordType),t.setVideoRecordType,t),this.setNativeConfiguration(this.onModuleLoaded,t.setOnModuleLoaded,t),this.setNativeConfiguration(this.onStabilizing,t.setOnStabilizing,t),this.setNativeConfiguration(this.onExtractionFinish,t.setOnExtractionFinish,t),this.setNativeConfiguration(this.onUserCancel,t.setOnUserCancel,t),this.setNativeConfiguration(this.onExceptionCaptured,t.setOnExceptionCaptured,t),this.setNativeConfiguration(this.onLivenessError,t.setOnLivenessError,t),this.setNativeConfiguration(this.onLivenessErrorButtonClick,t.setOnLivenessErrorButtonClick,t),this.setNativeConfiguration(this.onExtractionTimeout,t.setOnExtractionTimeout,t),this.setNativeConfiguration(this.onTimeoutErrorButtonClick,t.setOnTimeoutErrorButtonClick,t),this.setNativeConfiguration(this.onTrackStatus,t.setOnTrackStatus,t),t},a.prototype.setNativeConfiguration=function(t,e,i){void 0===i&&(i=null),null!==t&&t!==undefined&&(i?e.bind(i):e)(t)},a.prototype.tryParseInt=function(t){var e=parseInt(t);return isNaN(e)?t:e},a.prototype.tryParseFloat=function(t){var e=parseFloat(t);return isNaN(e)?t:e},a);function a(){}var s=(u.poll=function(t,e,i,n){void 0===n&&(n=0);var o=r.timer(n,t).subscribe(function(){e()&&(o.unsubscribe(),i())})},u);function u(){}var c=(Object.defineProperty(g.prototype,"fPhiSelphiNamespace",{get:function(){return window.FPhi&&window.FPhi.Selphi?window.FPhi.Selphi:undefined},set:function(t){window.FPhi&&(window.FPhi.Selphi=t)},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"fPhiWidgetScriptPath",{get:function(){return this._assetsBasePath+"/FPhi.Widget.wasm.js"},enumerable:!0,configurable:!0}),g.prototype.loadControl=function(t){var e=this;this._assetsBasePath=t;var i=this._renderer.createElement("script");return this._renderer.setAttribute(i,"src",this.fPhiWidgetScriptPath),this._renderer.setAttribute(i,"type","text/javascript"),this._renderer.appendChild(this.document.body,i),new n.Observable(function(t){s.poll(5,function(){return null!==e.fPhiSelphiNamespace&&e.fPhiSelphiNamespace!==undefined&&null!==e.fPhiSelphiNamespace.Widget&&e.fPhiSelphiNamespace.Widget!==undefined},function(){return t.next(e)})})},g.prototype.removeControl=function(){return this._assetsBasePath&&(delete this._fPhiWidget,delete this._fPhiWidgetConfiguration,delete this.fPhiSelphiNamespace,this._fPhiWidget=undefined,this._fPhiWidgetConfiguration=undefined,this.fPhiSelphiNamespace=undefined,this.document.querySelectorAll('script[src*="'+this._assetsBasePath+'"]').forEach(function(t){t.parentNode.removeChild(t)}),this.document.querySelectorAll("style#FPhi_Widget_style").forEach(function(t){t.parentNode.removeChild(t)})),this},g.prototype.createUserControl=function(t){return this._fPhiWidgetConfiguration=t,this._fPhiWidget=new this.fPhiSelphiNamespace.Widget(t.getNativeConfiguration()),null!==this._fPhiWidgetConfiguration.debugMode&&this._fPhiWidgetConfiguration.debugMode!==undefined&&(this._fPhiWidget.debug=this._fPhiWidgetConfiguration.debugMode),this},g.prototype.startUserControl=function(){return this._fPhiWidget&&this._fPhiWidget.Start(),this},g.prototype.stopUserControl=function(){return this._fPhiWidget&&this._fPhiWidget.Stop(),this},g.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],g.ctorParameters=function(){return[{type:undefined,decorators:[{type:e.Inject,args:[i.DOCUMENT]}]},{type:e.RendererFactory2}]},g.ngInjectableDef=e.defineInjectable({factory:function(){return new g(e.inject(i.DOCUMENT),e.inject(e.RendererFactory2))},token:g,providedIn:"root"}),g);function g(t,e){this.document=t,this.rendererFactory=e,this._renderer=this.rendererFactory.createRenderer(null,null)}var h=(Object.defineProperty(p.prototype,"cssClass",{get:function(){return this._cssClass},set:function(t){t&&(this._cssClass+=" "+t)},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"widgetWidth",{get:function(){return this.componentWidth?"string"==typeof this.componentWidth&&this.componentWidth.endsWith("%")?this.componentWidth:parseFloat(this.componentWidth)!==NaN?parseFloat(this.componentWidth)+"px":this.componentWidth:"100%"},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"widgetHeight",{get:function(){return this.componentHeight?"string"==typeof this.componentHeight&&this.componentHeight.endsWith("%")?this.componentHeight:parseFloat(this.componentHeight)!==NaN?parseFloat(this.componentHeight)+"px":this.componentHeight:"100%"},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"resourcesPath",{get:function(){return this._widgetConfiguration.resourcesPath},set:function(t){this._widgetConfiguration.resourcesPath=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"graphPath",{get:function(){return this._widgetConfiguration.graphPath},set:function(t){this._widgetConfiguration.graphPath=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"language",{get:function(){return this._widgetConfiguration.language},set:function(t){this._widgetConfiguration.language=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"dpiList",{get:function(){return this._widgetConfiguration.dpiList},set:function(t){this._widgetConfiguration.dpiList=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"cameraWidth",{get:function(){return this._widgetConfiguration.cameraWidth},set:function(t){this._widgetConfiguration.cameraWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"cameraHeight",{get:function(){return this._widgetConfiguration.cameraHeight},set:function(t){this._widgetConfiguration.cameraHeight=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"cameraRotation",{get:function(){return this._widgetConfiguration.cameraRotation},set:function(t){this._widgetConfiguration.cameraRotation=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"cameraType",{get:function(){return this._widgetConfiguration.cameraType},set:function(t){this._widgetConfiguration.cameraType=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"tutorial",{get:function(){return this._widgetConfiguration.tutorial},set:function(t){this._widgetConfiguration.tutorial=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"extractionMode",{get:function(){return this._widgetConfiguration.extractionMode},set:function(t){this._widgetConfiguration.extractionMode=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"livenessMode",{get:function(){return this._widgetConfiguration.livenessMode},set:function(t){this._widgetConfiguration.livenessMode=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"livenessPrecision",{get:function(){return this._widgetConfiguration.livenessPrecision},set:function(t){this._widgetConfiguration.livenessPrecision=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"livenessMoveInitialError",{get:function(){return this._widgetConfiguration.livenessMoveInitialError},set:function(t){this._widgetConfiguration.livenessMoveInitialError=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"livenessMoveInfoTime",{get:function(){return this._widgetConfiguration.livenessMoveInfoTime},set:function(t){this._widgetConfiguration.livenessMoveInfoTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"interactible",{get:function(){return this._widgetConfiguration.interactible},set:function(t){this._widgetConfiguration.interactible=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"registerTime",{get:function(){return this._widgetConfiguration.registerTime},set:function(t){this._widgetConfiguration.registerTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"authenticateTime",{get:function(){return this._widgetConfiguration.authenticateTime},set:function(t){this._widgetConfiguration.authenticateTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"imageFormat",{get:function(){return this._widgetConfiguration.imageFormat},set:function(t){this._widgetConfiguration.imageFormat=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"imageQuality",{get:function(){return this._widgetConfiguration.imageQuality},set:function(t){this._widgetConfiguration.imageQuality=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"logImages",{get:function(){return this._widgetConfiguration.logImages},set:function(t){this._widgetConfiguration.logImages=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"cropFactor",{get:function(){return this._widgetConfiguration.cropFactor},set:function(t){this._widgetConfiguration.cropFactor=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"cropImage",{get:function(){return this._widgetConfiguration.cropImage},set:function(t){this._widgetConfiguration.cropImage=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"templateFormat",{get:function(){return this._widgetConfiguration.templateFormat},set:function(t){this._widgetConfiguration.templateFormat=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"stabilizationStage",{get:function(){return this._widgetConfiguration.stabilizationStage},set:function(t){this._widgetConfiguration.stabilizationStage=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"videoRecord",{get:function(){return this._widgetConfiguration.videoRecord},set:function(t){this._widgetConfiguration.videoRecord=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"videoRecordRate",{get:function(){return this._widgetConfiguration.videoRecordRate},set:function(t){this._widgetConfiguration.videoRecordRate=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"videoRecordScale",{get:function(){return this._widgetConfiguration.videoRecordScale},set:function(t){this._widgetConfiguration.videoRecordScale=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"videoRecordType",{get:function(){return this._widgetConfiguration.videoRecordType},set:function(t){this._widgetConfiguration.videoRecordType=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"debugMode",{get:function(){return this._widgetConfiguration.debugMode},set:function(t){this._widgetConfiguration.debugMode=t},enumerable:!0,configurable:!0}),p.prototype.ngOnInit=function(){var t=this;function e(){t.onComponentLoaded.emit(),t.widgetService.createUserControl(t._widgetConfiguration).startUserControl()}this._widgetConfiguration.widgetContainer=this.widgetContainer.nativeElement,this.setupEvents(),this.autoLoadLibResources?this.widgetService.loadControl(this.widgetLibPath).subscribe(e):e()},p.prototype.ngOnDestroy=function(){this.autoLoadLibResources&&this.widgetService.stopUserControl().removeControl()},p.prototype.setupEvents=function(){var e=this;return this._widgetConfiguration.onModuleLoaded=function(t){e.onModuleLoaded.emit(t)},this._widgetConfiguration.onStabilizing=function(t){e.onStabilizing.emit(t)},this._widgetConfiguration.onExtractionFinish=function(t){e.onExtractionFinish.emit(t)},this._widgetConfiguration.onUserCancel=function(){e.onUserCancel.emit()},this._widgetConfiguration.onExceptionCaptured=function(t){e.onExceptionCaptured.emit(t)},this._widgetConfiguration.onLivenessError=function(t){e.onLivenessError.emit(t)},this._widgetConfiguration.onLivenessErrorButtonClick=function(){e.onLivenessErrorButtonClick.emit()},this._widgetConfiguration.onExtractionTimeout=function(t){e.onExtractionTimeout.emit(t)},this._widgetConfiguration.onTimeoutErrorButtonClick=function(){e.onTimeoutErrorButtonClick.emit()},this._widgetConfiguration.onTrackStatus=function(t){e.onTrackStatus.emit(t)},this},p.decorators=[{type:e.Component,args:[{selector:"facephi-selphi",template:'<div #widgetContainer\n     [style.width]="widgetWidth"\n     [style.height]="widgetHeight"\n     [ngClass]="containerCssClass">\n</div>\n\n',styles:[""]}]}],p.ctorParameters=function(){return[{type:c}]},p.propDecorators={cssClass:[{type:e.Input,args:["class"]},{type:e.HostBinding,args:["class"]}],componentWidth:[{type:e.Input,args:["width"]}],componentHeight:[{type:e.Input,args:["height"]}],widgetContainer:[{type:e.ViewChild,args:["widgetContainer"]}],containerCssClass:[{type:e.Input}],widgetLibPath:[{type:e.Input}],autoLoadLibResources:[{type:e.Input}],resourcesPath:[{type:e.Input}],graphPath:[{type:e.Input}],language:[{type:e.Input}],dpiList:[{type:e.Input}],cameraWidth:[{type:e.Input}],cameraHeight:[{type:e.Input}],cameraRotation:[{type:e.Input}],cameraType:[{type:e.Input}],tutorial:[{type:e.Input}],extractionMode:[{type:e.Input}],livenessMode:[{type:e.Input}],livenessPrecision:[{type:e.Input}],livenessMoveInitialError:[{type:e.Input}],livenessMoveInfoTime:[{type:e.Input}],interactible:[{type:e.Input}],registerTime:[{type:e.Input}],authenticateTime:[{type:e.Input}],imageFormat:[{type:e.Input}],imageQuality:[{type:e.Input}],logImages:[{type:e.Input}],cropFactor:[{type:e.Input}],cropImage:[{type:e.Input}],templateFormat:[{type:e.Input}],stabilizationStage:[{type:e.Input}],videoRecord:[{type:e.Input}],videoRecordRate:[{type:e.Input}],videoRecordScale:[{type:e.Input}],videoRecordType:[{type:e.Input}],debugMode:[{type:e.Input}],onComponentLoaded:[{type:e.Output}],onModuleLoaded:[{type:e.Output}],onStabilizing:[{type:e.Output}],onExtractionFinish:[{type:e.Output}],onUserCancel:[{type:e.Output}],onExceptionCaptured:[{type:e.Output}],onLivenessError:[{type:e.Output}],onLivenessErrorButtonClick:[{type:e.Output}],onExtractionTimeout:[{type:e.Output}],onTimeoutErrorButtonClick:[{type:e.Output}],onTrackStatus:[{type:e.Output}]},p);function p(t){this.widgetService=t,this._cssClass="",this._widgetConfiguration=new o,this.widgetLibPath="assets/lib/facephi/selphi",this.autoLoadLibResources=!0,this.onComponentLoaded=new e.EventEmitter,this.onModuleLoaded=new e.EventEmitter,this.onStabilizing=new e.EventEmitter,this.onExtractionFinish=new e.EventEmitter,this.onUserCancel=new e.EventEmitter,this.onExceptionCaptured=new e.EventEmitter,this.onLivenessError=new e.EventEmitter,this.onLivenessErrorButtonClick=new e.EventEmitter,this.onExtractionTimeout=new e.EventEmitter,this.onTimeoutErrorButtonClick=new e.EventEmitter,this.onTrackStatus=new e.EventEmitter}var d=(f.CameraRotation={None:0,Deg90:1,Deg180:2,Deg270:3},f.ExtractionMode={Register:0,Authenticate:1},f.LivenessMode={None:0,Blink:1,Move:2,Passive:3},f.ExceptionType={CameraError:0,ExtractorError:1,ControlNotInitializedError:2,ImageCropResizeError:3,UnexpectedCaptureError:4},f.SampleDiagnostic={Ok:0,FaceNotFound:1,RightEyeNotFound:2,LeftEyeNotFound:3,EyesNotFound:4,FaceTooFar:5,FaceTooClose:6,TooCloseToWindowSide:7,AngleExceeded:8,QualityCheckFailed:9,NotRated:10},f.FinalDiagnostic={InsufficientValidSamples:0,TemplateCreationInProgress:1,TemplateCreated:2},f.LivenessDiagnostic={NotRated:0,PhotoDetected:1,LivenessDetected:2,Unsuccess:3,UnsuccessLowPerformance:4,UnsuccessGlasses:5,UnsuccessLight:6,UnsuccessNoMovement:7,UnsuccessWrongDirection:8,UnsuccessTooFar:9},f.TemplateFormat={ByteArray:0,Base64:1},f.RecorderType={Gif:0,Remote:1},f.CameraType={Front:0,Back:1},f.TrackStatus={ChangeState:0,Tap:1},f);function f(){}var l=(m.decorators=[{type:e.NgModule,args:[{declarations:[h],imports:[i.CommonModule],exports:[h]}]}],m);function m(){}t.FacePhiSelphiComponent=h,t.FPhiSelphiConfiguration=o,t.FPhiSelphiConstants=d,t.FacePhiSelphiModule=l,t.ɵa=c,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=facephi-selphi.umd.min.js.map